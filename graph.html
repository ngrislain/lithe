<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Lithe — Tensor Expression Graph</title>
<style>
  body { font-family: Helvetica, Arial, sans-serif; margin: 20px; background: #1a1a2e; color: #eee; }
  h1 { color: #4A90D9; }
  #graph { background: #16213e; border-radius: 8px; padding: 20px; }
  .legend { display: flex; gap: 20px; margin: 10px 0; }
  .legend-item { display: flex; align-items: center; gap: 6px; }
  .legend-color { width: 16px; height: 16px; border-radius: 3px; }
</style>
</head>
<body>
<h1>Lithe — Tensor Expression Graph</h1>
<div class="legend">
  <div class="legend-item"><div class="legend-color" style="background:#4A90D9"></div>Data</div>
  <div class="legend-item"><div class="legend-color" style="background:#7BC67E"></div>Elementwise</div>
  <div class="legend-item"><div class="legend-color" style="background:#F5A623"></div>Shape</div>
  <div class="legend-item"><div class="legend-color" style="background:#D94A4A"></div>Reduction</div>
  <div class="legend-item"><div class="legend-color" style="background:#9B59B6"></div>Contraction</div>
</div>
<div id="graph"></div>
<script src="https://cdn.jsdelivr.net/npm/viz.js@2.1.2/viz.js"></script>
<script src="https://cdn.jsdelivr.net/npm/viz.js@2.1.2/full.render.js"></script>
<script>
const dot = `digraph TensorExpr {
  rankdir=TB;
  node [style=filled, fontname="Helvetica"];
  n0 [label="literal\\n[2,3]", fillcolor="#4A90D9", fontcolor=white];
  n1 [label="literal\\n[3,2]", fillcolor="#4A90D9", fontcolor=white];
  n2 [label="einsum\\n[2,2]", fillcolor="#9B59B6", fontcolor=white];
  n3 [label="relu\\n[2,2]", fillcolor="#7BC67E", fontcolor=white];
  n0 -> n2;
  n1 -> n2;
  n2 -> n3;
}
`;
const viz = new Viz();
viz.renderSVGElement(dot).then(svg => {
  document.getElementById('graph').appendChild(svg);
}).catch(err => {
  document.getElementById('graph').innerHTML = '<pre>' + err + '</pre>';
});
</script>
</body>
</html>